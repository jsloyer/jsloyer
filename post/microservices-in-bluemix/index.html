<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Monolith apps are no more. The age of the monolith is over. It wasn‚Äôt that long ago that companies and developers (myself included) were deploying one giant app that did everything. The app would serve all your static files, front-end HTML and CSS and Javascript, act as your REST API, serve as your data persistance tier, handles sessions, handle logins, and do security for your app. The list could keep going on and on. As the age of the code base progresses it gets more and more complicated and tangled and if a new feature needs to be developed or an old piece of code needs to be modified it takes a cross functional team of many different people to make it happen.\n"><title>Microservices in Bluemix</title><link rel=canonical href=https://www.jeffsloyer.io/post/microservices-in-bluemix/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="Microservices in Bluemix"><meta property='og:description' content="Monolith apps are no more. The age of the monolith is over. It wasn‚Äôt that long ago that companies and developers (myself included) were deploying one giant app that did everything. The app would serve all your static files, front-end HTML and CSS and Javascript, act as your REST API, serve as your data persistance tier, handles sessions, handle logins, and do security for your app. The list could keep going on and on. As the age of the code base progresses it gets more and more complicated and tangled and if a new feature needs to be developed or an old piece of code needs to be modified it takes a cross functional team of many different people to make it happen.\n"><meta property='og:url' content='https://www.jeffsloyer.io/post/microservices-in-bluemix/'><meta property='og:site_name' content='Jeff Sloyer'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='amqp'><meta property='article:tag' content='microservices'><meta property='article:tag' content='bluemix'><meta property='article:tag' content='mqtt'><meta property='article:tag' content='node.js'><meta property='article:tag' content='websockets'><meta property='article:published_time' content='2015-01-19T09:34:18-05:00'><meta property='article:modified_time' content='2015-01-19T09:34:18-05:00'><meta property='og:image' content='https://www.jeffsloyer.io/post/microservices-in-bluemix/two-pizza.jpg'><meta name=twitter:title content="Microservices in Bluemix"><meta name=twitter:description content="Monolith apps are no more. The age of the monolith is over. It wasn‚Äôt that long ago that companies and developers (myself included) were deploying one giant app that did everything. The app would serve all your static files, front-end HTML and CSS and Javascript, act as your REST API, serve as your data persistance tier, handles sessions, handle logins, and do security for your app. The list could keep going on and on. As the age of the code base progresses it gets more and more complicated and tangled and if a new feature needs to be developed or an old piece of code needs to be modified it takes a cross functional team of many different people to make it happen.\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://www.jeffsloyer.io/post/microservices-in-bluemix/two-pizza.jpg'><link rel="shortcut icon" href=/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-1SGYYQEYE5"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1SGYYQEYE5")}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/airplane_hu_b02b01ef7f6fbee8.png width=300 height=225 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>Jeff Sloyer</a></h1><h2 class=site-description>Thoughts on Tech and other interests...</h2></div></header><ol class=menu-social><li><a href=https://github.com/jsloyer target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/jeffsloyer/ target=_blank title="Linked In" rel=me><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li><li><a href=https://twitter.com/jsloyer target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/speaking/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>Speaking</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#what-is-a-monolith>What is a Monolith?</a></li><li><a href=#microserviceadvantages>Microservice¬†Advantages</a></li><li><a href=#2-pizza-teams>2 Pizza Teams</a></li><li><a href=#i-wanna-go-fast-its-all-about-speed>I Wanna Go Fast (It‚Äôs All About Speed)</a></li><li><a href=#devops-devops-devops>DevOps DevOps DevOps</a></li><li><a href=#let-the-devs-rule>Let the Dev‚Äôs rule</a></li><li><a href=#design-for-failure>Design for Failure</a></li><li><a href=#immutable-code>Immutable Code</a></li><li><a href=#real-world-microservices-architecture>Real world Microservices architecture</a></li><li><a href=#how-to-use-bluemix-to-create-microservices>How to use Bluemix to create Microservices</a></li><li><a href=#example-app-in-bluemix>Example App in Bluemix</a></li><li><a href=#stay-tuned>Stay Tuned!!!</a></li><li><a href=#webcastplayback>Webcast¬†playback</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/microservices-in-bluemix/><img src=/post/microservices-in-bluemix/two-pizza_hu_f80a8408cded1c59.jpg srcset="/post/microservices-in-bluemix/two-pizza_hu_f80a8408cded1c59.jpg 800w, /post/microservices-in-bluemix/two-pizza_hu_7b1c90603359e7dc.jpg 1600w" width=800 height=534 loading=lazy alt="Featured image of post Microservices in Bluemix"></a></div><div class=article-details><header class=article-category><a href=/categories/sample-code/>Sample Code
</a><a href=/categories/tutorial/>Tutorial</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/microservices-in-bluemix/>Microservices in Bluemix</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jan 19, 2015</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>12 minute read</time></div></footer></div></header><section class=article-content><p>Monolith apps are no more. ¬†The age of the monolith is over. ¬†It wasn‚Äôt that long ago that companies and developers (myself included) were deploying one giant app that did everything. ¬†The app would serve all your static files, front-end HTML and CSS and Javascript, act as your REST API, serve as your data persistance tier, handles sessions, handle logins, and do security for your app. ¬†The list could keep going on and on. ¬†As the age of the code base progresses it gets more and more complicated and tangled and if a new feature needs to be developed or an old piece of code needs to be modified it takes a cross functional team of many different people to make it happen.</p><p>First we are going to talk about how a monolith app works, some of the positives and negatives and then we will talk about how things work in an app utilizing microserivces and the positivities and negatives associated with it.</p><h2 id=what-is-a-monolith>What is a Monolith?</h2><p>In a traditional monolith app you would have your basic three tier app consisting of a persistence layer, middleware tier/business logic, and front end code. ¬†The advantage of this is there is just one application to manage and scale. ¬†However the downside is that any change to any of the three tiers it requires cranking up the giant distributed team and pushing a new release. ¬†For example, if Dave a front-end dev wanted and he wanted to¬†change the color of a button, it would require the whole app to built, tested, and re-deployed¬†for a tiny change.</p><p>This is quite wasteful over everyone‚Äôs time, dev‚Äôs from the¬†persistence layer, business logic team, and front end team need to be involved. ¬†This involves cutting a new release, running it through whatever QA/test phases there is and pushing it to production and hoping that nothing else got¬†introduced¬†or anyone else regressed some features.</p><p>Additionally, by having a monolith app the code base can become quite large and incredibly complex to maintain. ¬†This is¬†compounded¬†exponentially as the age of an app grows. ¬†Eventually, there is so much tangled and twisted code its hard to understand how things link together and work. ¬†This is one of the hidden costs of a monolith app.</p><h2 id=microserviceadvantages>Microservice¬†Advantages</h2><p>A microservice can be defined simply as &ldquo;fine grained SOA&rdquo; ‚Äì¬†Adrian Cockcroft, Netflix. ¬†In a longer description it can be thought of a set of small services with known functionality communicating over a common lightweight API, either HTTP REST API‚Äôs or more recently a lightweight messaging protocol (more on this later).</p><blockquote>"Fine grained SOA" Adrian Cockcroft, Netflix</blockquote><p>Microservices provide a huge advantage for the case we talked about earlier¬†where Dave our front-end dev wants to change the color of a button, no longer does the giant dev machine need to be involved. ¬†Instead the UI layer is a¬†separate¬†service and changes can be made independent from other parts of the application.¬†¬†The UI team can crank out as many releases as their heart desires.</p><h2 id=2-pizza-teams>2 Pizza Teams</h2><p>We aren‚Äôt talking about skimping on our employees and not feeding them enough at work, but we are instead talking about the size of the team. ¬†Amazon first coined this term back in 2011. ¬†It has been written about extensively and in such publications as the <a class=link href=http://www.wsj.com/articles/SB10001424052970203914304576627102996831200 target=_blank rel=noopener>Wall Street Journal</a>. ¬†Basically what it boils down to is having each team¬†small enough that you can feed them with 2 pizza‚Äôs. ¬†So you might be asking what the importance of this is, let‚Äôs use our example of our front-end dev Dave again. ¬†By Dave having a small team they can organize themselves efficiently and deliver functionality on their own instead of being tied to a giant release of the application. ¬†A team doesn‚Äôt have to multiple people, it can actually be a team of just 1 but be sure to never violate the 2 pizza team rule though.</p><p><a class=link href=two-pizza.jpg><img src=/post/microservices-in-bluemix/two-pizza.jpg width=1000 height=667 srcset="/post/microservices-in-bluemix/two-pizza_hu_7067633b1c28bdb6.jpg 480w, /post/microservices-in-bluemix/two-pizza_hu_9e0e32752c41a8cc.jpg 1024w" loading=lazy alt="two pizza 300x200 Microservices in Bluemix" class=gallery-image data-flex-grow=149 data-flex-basis=359px></a></p><h2 id=i-wanna-go-fast-its-all-about-speed>I Wanna Go Fast (It‚Äôs All About Speed)</h2><p>As popularized by Talladega Nights, speed is king. ¬†Who doesn‚Äôt want to go fast? ¬†If you answered no to that you are probably going to get beaten by your competition and be left in the dust. ¬†As the <a class=link href=http://www.thomaslfriedman.com/bookshelf/the-world-is-flat target=_blank rel=noopener>world is being flattened</a> there is constantly new competition every day and dev team‚Äôs have to constantly be delivering to keep their product and company relevant.</p><p>So back to our example of ¬†Dave our front-end dev again. Since Dave‚Äôs team has¬†their own UI service they can constantly deliver changes and new features without having to wait for other team‚Äôs to deliver functionality. ¬†Dave‚Äôs team can even deliver new UI code that is gated on some business logic code by using <a class=link href=https://codeascraft.com/2011/02/04/how-does-etsy-manage-development-and-operations/ target=_blank rel=noopener>feature flags</a> and <a class=link href=http://apptimize.com/blog/2014/01/etsy-continuous-innovation-ab-testing/ target=_blank rel=noopener>A/B testing</a> to selectively enable code and test new code out. ¬†This allows Dave‚Äôs team to try out new ideas and if they don‚Äôt work they fail fast and pivot and change course. ¬†By doing this Dave‚Äôs product and company stay relevant.</p><p>Again as Ricky Bobby from Talladega Nights would say, &ldquo;if you aint¬†first you‚Äôre last.&rdquo; ¬†When I saw the movie my mind obviously just went to car racing and sports but it can be extended to the IT industry as well. ¬†If you aren‚Äôt first you probably aren‚Äôt relevant and someone else is beating you to market. ¬†Eventually you could go out of business.</p><h2 id=devops-devops-devops>DevOps DevOps DevOps</h2><p><a class=link href=devops-borat.jpg><img src=/post/microservices-in-bluemix/devops-borat.jpg width=347 height=335 srcset="/post/microservices-in-bluemix/devops-borat_hu_1346fd97b2ab58b7.jpg 480w, /post/microservices-in-bluemix/devops-borat_hu_5f4210682ac1cea7.jpg 1024w" loading=lazy alt="devops borat Microservices in Bluemix" class=gallery-image data-flex-grow=103 data-flex-basis=248px></a>&ldquo;To make error is human. To propagate error to all server in automatic way is <a class=link href="https://twitter.com/hashtag/devops?src=hash" target=_blank rel=noopener>#<strong>devops</strong></a>.&rdquo; ‚Äì <a class=link href=https://twitter.com/devops_borat target=_blank rel=noopener>DevOps Borat</a>. ¬†This <a class=link href=https://twitter.com/devops_borat/status/41587168870797312 target=_blank rel=noopener>quote</a> sums up why DevOps is important. ¬†With each service being completely different architecture wise and language it is in it would be near impossible for a central &ldquo;ops&rdquo; team to manage all the apps. ¬†Instead in microservices world each team is responsible for their own app. ¬†You might be thinking that having dev‚Äôs manage a production service is bad and they won‚Äôt be responsive. ¬†You are wrong, multiple companies have been doing this for years and it actually creates a sense of empowerment in the dev team. ¬†Dev‚Äôs don‚Äôt want a call at 3am in the morning notifying them that their service is down. ¬†In turn dev‚Äôs start taking more pride in their work and start thinking about decisions they make that will affect the availability of their service. ¬†It creates a new mindset for people.</p><h2 id=let-the-devs-rule>Let the Dev‚Äôs rule</h2><p>Continuing on from above empowering dev‚Äôs is super important. ¬†As a developer feels empowered they will make better decisions for their service they work on and thus end up making better decisions for the company. ¬†When someone feels empowered they are putting their stamp of approval behind a product or feature and basically signing it with their name, code to them is a craft.</p><p>By embracing microservices and the de-centralized architecture it allows dev‚Äôs to innovate and come up with cool ideas and test them out. ¬†If they don‚Äôt work that is ok, keep innovating and moving forward. ¬†I am a photographer and in college someone once told me for every 10 pictures you take you will only get one good one. ¬†The same can be said here as well, try, test, measure ¬†(repeat). Obviously there is some science and planning put into this but the point is creating an environment to foster innovation.</p><h2 id=design-for-failure>Design for Failure</h2><p>When using microservices each service should be able to stand on its own and run by itself. ¬†If it has outside dependencies it isn‚Äôt really a microservice. ¬†Netflix is a prime example of this. ¬†For example, if a service goes down that generates recommendations the whole site doesn‚Äôt break. ¬†Other services keep functioning without the broken service. ¬†In some cases, other services will know how to operate without the broken service. ¬†Feature degradation or local caching can be used to prevent a break in the user experience.</p><p>This is designing for failure. ¬†In the monolith world (which remember no longer exists) we would design and develop for the happy path and really never for the sad path. ¬†By having a service based architecture we need to design and develop for¬†the failure¬†cases. ¬†Some guy digging in his front yard could cut a piece of fiber and bring our monolith app to the ground. ¬†By designing for a service not being there and allowing the product to continue to function is at utmost important. ¬†In the monolith app dev‚Äôs sometimes would not think this way because everything is self contained by in a decentralized architecture you are forced to think about the failure case and how to handle it in a graceful way that doesn‚Äôt affect the user‚Äôs experience too much.</p><h2 id=immutable-code>Immutable Code</h2><p>Part of this thought of designing for failure is having immutable code. ¬†When introducing new code you MUST not affect the functionality of previous code. ¬†In a product that has a UI this is a little harder to do but can be done with feature flags and A/B testing but with an API based service changing the inputs and outputs of a service is a big no-no. ¬†If you absolutely must do this at least have a deprecation period of N+2 or 3 to give customers and consumers of your service some advanced warning that changes are coming. ¬†Ideally you wouldn‚Äôt deprecate an API, just revision your API, for example if you are using HTTP REST API‚Äôs just use <code>/api/v1.0/</code> and for your next version <code>/api/v1.1/</code> as a prefix.</p><h2 id=real-world-microservices-architecture>Real world Microservices architecture</h2><p>In the real world we would probably have a database, some business logic service (probably multiple of these), a UI service, our basic three tier app but this time disjoint from each other. ¬†See below.
The &ldquo;glue&rdquo; between the services is supposed to be something light-weight, you can use HTTP REST API‚Äôs but more recently there has been a move to a messaging based &ldquo;glue&rdquo;. ¬†In particular like MQTT or AMQP. ¬†This is great as it allows a service to be a &ldquo;worker&rdquo; or a client of another service, or in queuing terms, producers and consumers.</p><h2 id=how-to-use-bluemix-to-create-microservices>How to use Bluemix to create Microservices</h2><p>To demonstrate this real world example let‚Äôs talk about how this would work in Bluemix. ¬†In Bluemix we can create a bunch of services, in case they will be in Node.js and the &ldquo;glue&rdquo; between our services will be MQLight. ¬†An important point we should talk about here is the notion of producer/consumer (pub/sub) vs round-robin queuing.</p><p>For our example let‚Äôs say we have a service that is scaled out to 5 nodes (we must be really popular). ¬†Each of these nodes is a worker for some business process, in this case let‚Äôs say sending a registration email. ¬†When someone sign‚Äôs up for our site we want to send them a registration email, we don‚Äôt want each of the 5 nodes of our service emailing the person. ¬†I would probably walk away from something if I got 5 duplicate registration emails. ¬†In this case we want round-robin queuing.</p><p>However on the converse side there is cases where we want producer/consumer (pub/sub queuing). ¬†This effectively means all 5 nodes of a service will receive the same message and respond. ¬†Let‚Äôs say we have a UI service that is the front-end for a real time chat service. ¬†If our application is scaled out to 5 nodes how can we properly propagate chat messages to all the connected clients. ¬†The answer is allowing each front-end service to receive the same message to relay to all the clients.</p><p><a class=link href=mqlight.jpg><img src=/post/microservices-in-bluemix/mqlight.jpg width=152 height=172 srcset="/post/microservices-in-bluemix/mqlight_hu_50572d322f66d781.jpg 480w, /post/microservices-in-bluemix/mqlight_hu_f9b2d8ee244c2042.jpg 1024w" loading=lazy alt="mqlight Microservices in Bluemix" class=gallery-image data-flex-grow=88 data-flex-basis=212px></a>When architecting your microservices you need to keep queuing in mind and how clients and services communicate with each other. ¬†Make sure you choose a queuing technology that supports your desired behavior of pub/sub or round-robin.</p><p>So where does this leave us in Bluemix? ¬†MQLight, with MQLight you can easily do pub/sub and round-robin with the same service provider. ¬†This is great because as the developer I don‚Äôt have to use two different messaging providers.</p><h2 id=example-app-in-bluemix>Example App in Bluemix</h2><p>So let‚Äôs build something to demonstrate all of this. ¬†The example app we will be building contains a front-end service that allows users to enter text and another service that will convert it to upper case. ¬†While this is not a real world example it demonstrates microservices using backend workers.</p><p>A real world example might be ¬†an image processing app that applies a sexy filter to an image it and then uploads it to Instagram. ¬†If we did this we could break this up into three services. ¬†A web service that accepts an image over http(s), our sexy filter engine (maybe imagemagick), then a service that uploads the image to our social media network of choice.</p><p>So back to our example app of converting text to uppercase. ¬†The UI is below, our UI doesn‚Äôt lock when we submit data and we can keep using it. ¬†As results are finished processing in our &ldquo;text uppercase&rdquo; service, results are delivered real time to our front-end service.</p><p><a class=link href=sample_screenshot.png><img src=/post/microservices-in-bluemix/sample_screenshot.png width=850 height=665 srcset="/post/microservices-in-bluemix/sample_screenshot_hu_1a4a74cf507bffba.png 480w, /post/microservices-in-bluemix/sample_screenshot_hu_9199b12fd7aeb75d.png 1024w" loading=lazy alt="sample screenshot Microservices in Bluemix" class=gallery-image data-flex-grow=127 data-flex-basis=306px></a></p><p>To make this seem more world the example code introduces some timeouts/waits to make it seem like some backend processing is going on in a microservice. ¬†To get this running follow the following steps.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl>    <span class=n>git</span> <span class=n>clone</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>hub</span><span class=o>.</span><span class=n>jazz</span><span class=o>.</span><span class=n>net</span><span class=o>/</span><span class=n>git</span><span class=o>/</span><span class=n>ibmmq</span><span class=o>/</span><span class=n>mqlight</span><span class=o>-</span><span class=n>worker</span><span class=o>-</span><span class=n>offload</span><span class=o>-</span><span class=n>sample</span><span class=o>-</span><span class=n>node</span>
</span></span><span class=line><span class=cl>    <span class=n>cf</span> <span class=n>create</span><span class=o>-</span><span class=n>service</span> <span class=n>MQLight</span> <span class=n>standard</span> <span class=n>MQLight</span><span class=o>-</span><span class=n>sampleservice</span>
</span></span><span class=line><span class=cl>    <span class=n>cf</span> <span class=n>push</span>
</span></span></code></pre></td></tr></table></div></div><p>What the above does is checkout some example code that contains a front-end service and a back-end service that does our &ldquo;text uppercasing&rdquo; and creates a QLight to provide the messaging between our two services.</p><p>Once the cf push command is done running (it might take a bit) we should see something like the following saying our apps are up.</p><p>Text processing¬†service:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Showing</span> <span class=n>health</span> <span class=ow>and</span> <span class=n>status</span> <span class=k>for</span> <span class=n>app</span> <span class=n>MQL</span><span class=o>.</span><span class=n>sample</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>backend</span> <span class=ow>in</span> <span class=n>org</span> <span class=n>jbsloyer</span><span class=err>@</span><span class=n>us</span><span class=o>.</span><span class=n>ibm</span><span class=o>.</span><span class=n>com</span> <span class=o>/</span> <span class=n>space</span> <span class=n>demos</span> <span class=n>as</span> <span class=n>jbsloyer</span><span class=err>@</span><span class=n>us</span><span class=o>.</span><span class=n>ibm</span><span class=o>.</span><span class=n>com</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>OK</span>
</span></span><span class=line><span class=cl><span class=n>requested</span> <span class=n>state</span><span class=p>:</span> <span class=n>started</span>
</span></span><span class=line><span class=cl><span class=n>instances</span><span class=p>:</span> <span class=mi>2</span><span class=o>/</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>usage</span><span class=p>:</span> <span class=mi>256</span><span class=n>M</span> <span class=n>x</span> <span class=mi>2</span> <span class=n>instances</span>
</span></span><span class=line><span class=cl><span class=n>urls</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>last</span> <span class=n>uploaded</span><span class=p>:</span> <span class=n>Mon</span> <span class=n>Jan</span> <span class=mi>19</span> <span class=mi>18</span><span class=p>:</span><span class=mi>52</span><span class=p>:</span><span class=mi>05</span> <span class=o>+</span><span class=mi>0000</span> <span class=mi>2015</span>
</span></span><span class=line><span class=cl>     <span class=n>state</span>     <span class=n>since</span>                    <span class=n>cpu</span>    <span class=n>memory</span>          <span class=n>disk</span>
</span></span><span class=line><span class=cl><span class=c1>#0   running   2015-01-19 01:53:08 PM   0.0%   11.8M of 256M   75.8M of 1G</span>
</span></span><span class=line><span class=cl><span class=c1>#1   running   2015-01-19 01:53:05 PM   0.0%   11.5M of 256M   75.8M of 1G</span>
</span></span><span class=line><span class=cl><span class=n>Front</span><span class=o>-</span><span class=n>end</span> <span class=n>service</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>Showing</span> <span class=n>health</span> <span class=ow>and</span> <span class=n>status</span> <span class=k>for</span> <span class=n>app</span> <span class=n>MQL</span><span class=o>.</span><span class=n>sample</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>frontend</span> <span class=ow>in</span> <span class=n>org</span> <span class=n>jbsloyer</span><span class=err>@</span><span class=n>us</span><span class=o>.</span><span class=n>ibm</span><span class=o>.</span><span class=n>com</span> <span class=o>/</span> <span class=n>space</span> <span class=n>demos</span> <span class=n>as</span> <span class=n>jbsloyer</span><span class=err>@</span><span class=n>us</span><span class=o>.</span><span class=n>ibm</span><span class=o>.</span><span class=n>com</span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>OK</span>
</span></span><span class=line><span class=cl><span class=n>requested</span> <span class=n>state</span><span class=p>:</span> <span class=n>started</span>
</span></span><span class=line><span class=cl><span class=n>instances</span><span class=p>:</span> <span class=mi>1</span><span class=o>/</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>usage</span><span class=p>:</span> <span class=mi>512</span><span class=n>M</span> <span class=n>x</span> <span class=mi>1</span> <span class=n>instances</span>
</span></span><span class=line><span class=cl><span class=n>urls</span><span class=p>:</span> <span class=n>mqlightsample</span><span class=o>-</span><span class=n>node</span><span class=o>-</span><span class=n>undeputed</span><span class=o>-</span><span class=n>trierarch</span><span class=o>.</span><span class=n>mybluemix</span><span class=o>.</span><span class=n>net</span>
</span></span><span class=line><span class=cl><span class=n>last</span> <span class=n>uploaded</span><span class=p>:</span> <span class=n>Mon</span> <span class=n>Jan</span> <span class=mi>19</span> <span class=mi>18</span><span class=p>:</span><span class=mi>53</span><span class=p>:</span><span class=mi>16</span> <span class=o>+</span><span class=mi>0000</span> <span class=mi>2015</span>
</span></span><span class=line><span class=cl>     <span class=n>state</span>     <span class=n>since</span>                    <span class=n>cpu</span>    <span class=n>memory</span>          <span class=n>disk</span>
</span></span><span class=line><span class=cl><span class=c1>#0   running   2015-01-19 01:54:20 PM   0.0%   24.3M of 512M   78.7M of 1G</span>
</span></span></code></pre></td></tr></table></div></div><p>So let‚Äôs checkout the app, I have recorded a short video of it working. ¬†If you notice the text service¬†is simulating things like a real world service might respond with results coming back as they finish being processed.</p><h2 id=stay-tuned>Stay Tuned!!!</h2><p>There will be some real world examples coming on how to use microservices in Bluemix since now we have a foundation on what microserivces are.¬† Please stay tuned and follow me on Twitter at <a class=link href=http://twitter.com/jsloyer target=_blank rel=noopener>@jsloyer</a>¬†for¬†some real world apps!</p><h2 id=webcastplayback>Webcast¬†playback</h2><p>The replay of the webcast is available at¬†<a class=link href=http://ibm.biz/BlmxMicroservices-Blog target=_blank rel=noopener>here</a>.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/amqp/>Amqp</a>
<a href=/tags/microservices/>Microservices</a>
<a href=/tags/bluemix/>Bluemix</a>
<a href=/tags/mqtt/>Mqtt</a>
<a href=/tags/node.js/>Node.js</a>
<a href=/tags/websockets/>Websockets</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/peering-inside-a-criminals-mind-using-ibm-watson/><div class=article-image><img src=/post/peering-inside-a-criminals-mind-using-ibm-watson/glasses.27d239de06198fae9a949f59a6820f1c_hu_6136c73f1583bc6d.jpg width=250 height=150 loading=lazy alt="Featured image of post Peering Inside a Criminal‚Äôs Mind using IBM Watson" data-key=peering-inside-a-criminals-mind-using-ibm-watson/ data-hash="md5-J9I53gYZj66alJ9ZpoIPHA=="></div><div class=article-details><h2 class=article-title>Peering Inside a Criminal‚Äôs Mind using IBM Watson</h2></div></a></article><article class=has-image><a href=/post/deploying-your-meteor-app-to-cloud-foundry-and-bluemix/><div class=article-image><img src=/post/deploying-your-meteor-app-to-cloud-foundry-and-bluemix/meteor.34fdd9fe4ffd23fa6e7a556bb707f229_hu_4d3fef20a3c842ea.jpg width=250 height=150 loading=lazy alt="Featured image of post Deploying your Meteor app to Cloud Foundry and Bluemix" data-key=deploying-your-meteor-app-to-cloud-foundry-and-bluemix/ data-hash="md5-NP3Z/k/9I/puelVrtwfyKQ=="></div><div class=article-details><h2 class=article-title>Deploying your Meteor app to Cloud Foundry and Bluemix</h2></div></a></article><article class=has-image><a href=/post/control-home-devices-with-bluemix-internet-of-things-part-2/><div class=article-image><img src=/post/control-home-devices-with-bluemix-internet-of-things-part-2/robots-blog-post-header1.4ed429e6ecd463ab7c1e1bceeda4646e_hu_d6470bfc8f84ab3e.jpg width=250 height=150 loading=lazy alt="Featured image of post Control home devices with Bluemix Internet of Things (Part 2)" data-key=control-home-devices-with-bluemix-internet-of-things-part-2/ data-hash="md5-TtQp5uzUY6t8HhvO7aRkbg=="></div><div class=article-details><h2 class=article-title>Control home devices with Bluemix Internet of Things (Part 2)</h2></div></a></article><article class=has-image><a href=/post/control-home-devices-with-bluemix-internet-of-things/><div class=article-image><img src=/post/control-home-devices-with-bluemix-internet-of-things/robots-blog-post-header1.4ed429e6ecd463ab7c1e1bceeda4646e_hu_d6470bfc8f84ab3e.jpg width=250 height=150 loading=lazy alt="Featured image of post Control home devices with Bluemix Internet of Things" data-key=control-home-devices-with-bluemix-internet-of-things/ data-hash="md5-TtQp5uzUY6t8HhvO7aRkbg=="></div><div class=article-details><h2 class=article-title>Control home devices with Bluemix Internet of Things</h2></div></a></article><article class=has-image><a href=/post/how-watson-and-bluemix-see-the-state-of-the-union/><div class=article-image><img src=/post/how-watson-and-bluemix-see-the-state-of-the-union/1USIIGtkypiwhO6W4o8cwIw.11cfdb1c8e52d58e90e87ed658730f85_hu_1e7947f9c586389c.jpeg width=250 height=150 loading=lazy alt="Featured image of post How Watson and Bluemix see the State of the Union" data-key=how-watson-and-bluemix-see-the-state-of-the-union/ data-hash="md5-Ec/bHI5S1Y6Q6H7WWHMPhQ=="></div><div class=article-details><h2 class=article-title>How Watson and Bluemix see the State of the Union</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//jeffsloyerio.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Jeff Sloyer</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>